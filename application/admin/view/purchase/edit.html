{extend name="template/base" /}
{block name="nav"}{/block}
{block name="content"}
<link rel="stylesheet" href="__static__/css/table.css">
<body>
<style type="text/css" media="screen">
header {
    color: black;
}
</style>
<div class="x-body" >
 <form class="form form-horizontal" id="form" method="post" action="{:\\think\\Request::instance()->baseUrl()}">
    <div class="heads">
    <span>
            <label class="active">采购方式：</label>
            <select name="buy_type">
                <option value="现购" {if condition="$vo.buy_type eq '现购'"}selected{/if}>现购</option>
                <option value="赊购" {if condition="$vo.buy_type eq '赊购'"}selected{/if}>赊购</option>
            </select>
            <label>订单编号：</label>
            <input type="text" style="border: 1px solid #dddddd" name="order_no" value="{$vo.order_no}" readonly="true">
            <label>采购合同编号：</label>
            <input type="text" style="border: 1px solid #dddddd" name="compact_no" value="{$vo.compact_no}">
    </span>
    <span>
            <label class="active">供应商名称：</label>
            <select name="supplier">
                {volist name='suppliers' id='list'}
                <option value="{$list.id}" {if condition="$vo['supplier'] eq $list['id']"} selected="true"{/if}>{$list.client_name}</option>
                {/volist}
            </select>
            <label>订单日期：</label>
            <input type="date" style="border: 1px solid #dddddd" name="order_time" value="{$vo.order_time}">
            <label>单据状态：</label>
            <input type="text" style="border: 1px solid #dddddd" name="bills_status" value="{$vo.bills_status}">
    </span>
</div>
<table class="table">
    <thead>
        <tr>
            <th>序号</th>
            <th>产品代码</th>
            <th>产品名称</th>
            <th>规格型号</th>
            <th>单位</th>
            <th>数量</th>
            <th>单价</th>
            <th>含税单价</th>
            <th>金额</th>
            <th>税率</th>
            <th>税额</th>
            <th>价税合计</th>
            <th>备注</th>
        </tr>
    </thead>
    <tbody>
        {volist name="vo['goods']" id='list' key='k'}
        <tr>
            <td><p></p><input type="hidden" name="ids[{$k}]"  value="{$list.id}" /></td>
            <td><input type="text" name="no[{$k}]"  value="{$list.no}" /></td>
            <td><input type="text" name="name[{$k}]" value="{$list.name}" /></td>
            <td><input type="text" name="type[{$k}]" value="{$list.type}"></td>
            <td><select class="select" name="unit[{$k}]">
                    {volist name='units' id='unit'}
                    <option value="{$unit.id}" {if condition="$list['unit'] eq $unit['id']"}selected{/if}>{$unit.name}</option>
                    {/volist}
                </select></td>
            <td><input type="text" name="num[{$k}]" value="{$list.num}"></td>
            <td><input type="text" name="unit_price[{$k}]" readonly="true" value="{$list.unit_price}"></td>
            <td><input type="text" name="tax_price[{$k}]" class="tax_price" value="{$list.tax_price}"></td>
            <td><input type="text" name="price[{$k}]" readonly="true" value="{$list.price}"></td>
            <td><input type="text" name="rates[{$k}]" value="17" class="rate" value="{$list.rate}"></td>
            <td><input type="text" name="rate_prices[{$k}]" readonly="true" value="{$list.rate_price}"></td>
            <td><input type="text" name="total_price[{$k}]" readonly="true" value="{$list.total_price}"></td>
            <td><input type="text" name="remarks[{$k}]" value="{$list.remark}"></td>
        </tr>
        {/volist}
        
    </tbody>
</table>

<table id="tpl" style="display: none;">
    <tr>
            <td><p></p></td>
            <td><input type="text" name="no[]" /></td>
            <td><input type="text" name="name[]" /></td>
            <td><input type="text" name="type[]"></td>
            <td><select class="select" name="unit[]">
                    {volist name='units' id='list'}
                    <option value="{$list.id}">{$list.name}</option>
                    {/volist}
                </select></td>
            <td><input type="text" name="num[]" ></td>
            <td><input type="text" name="unit_price[]" readonly="true"></td>
            <td><input type="text" name="tax_price[]" class="tax_price"></td>
            <td><input type="text" name="price[]" readonly="true"></td>
            <td><input type="text" name="rates[]" value="17" class="rate"></td>
            <td><input type="text" name="rate_prices[]" readonly="true"></td>
            <td><input type="text" name="total_price[]" readonly="true"></td>
            <td><input type="text" name="remark[]"></td>
        </tr>
</table>
<!--按钮-->
<table class="tabs">
        <tr style="background: #ffffff;">
            <!-- <td colspan="13"><p class="appends">新增+</p></td> -->
        </tr>
        <tr>
            <td><p>合计</p></td>
            <td><input type="text" disabled></td>
            <td><input type="text" disabled></td>
            <td><input type="text" disabled></td>
            <td><input type="text" disabled></td>
            <td><input type="text" class="getNum" readonly="true" style="cursor:pointer;"></td>
            <td><input type="text" disabled></td>
            <td><input type="text" disabled></td>
            <td><input type="text" class="getPrice" readonly="true" style="cursor:pointer;"></td>
            <td><input type="text" disabled></td>
            <td><input type="text" disabled></td>
            <td><input type="text" disabled></td>
            <td><input type="text" disabled></td>
        </tr>
</table>        
    <div class="footers">
        <!-- <div class="he"><label>说明：</label><input type="text" name="remarks"></div>
        <div class="fo">
             <label>折后应付金额：</label><input type="text" name="rate_money" />
             <label class="mar">折扣率：</label><input type="text" name="rate">%
             <label class="mar">本次付款：</label><input type="text" name="pay_money">
             <label class="mar">结算账户：</label><input type="text">
                </div> -->
        <div class="row cl">
            <label class="form-label col-xs-3 col-sm-3">备注：</label>
            <div class="formControls col-xs-6 col-sm-6">
                <input type="hidden" name="total_money" />
                <input type="hidden" name="total_num" />
                <textarea class="textarea"  placeholder="备注" name="remark" onKeyUp="textarealength(this,100)">{$vo.remark ?? ''}</textarea>
                <p class="textarea-numberbar"><em class="textarea-length">0</em>/100</p>
            </div>
            <div class="col-xs-3 col-sm-3"></div>
        </div>
        {if condition="GID eq 4 OR ADMIN "}
         <div class="row cl">
            <label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>状态：</label>
            <div class="formControls col-xs-6 col-sm-6 skin-minimal">
                <div class="radio-box">
                    <input type="radio" name="status" id="radio-1" value="1">
                    <label for="radio-0">启用</label>
                </div>
                <div class="radio-box">
                    <input type="radio" name="status" id="radio-0" value="0">
                    <label for="radio-1">禁用</label>
                </div>
                <input type="hidden" name="check_uid" value="{php}echo UID;{/php}">
            </div>
           
            <div class="col-xs-3 col-sm-3"> 
                 <label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>时间：</label>
                  <div class="formControls col-xs-6 col-sm-6">
                    <div class="radio-box">
                        <input type="date" name="check_time" value="{$vo.check_time ?? ''}">
                    </div>
                </div>
            </div>
        </div>
        {/if}
         <div class="row cl">
            <label class="form-label col-xs-3 col-sm-3"><span class="c-red">*</span>采购人：</label>
            <div class="formControls col-xs-6 col-sm-6">
                <input type="text" class="input-text" value="{$vo['user_info']['username'] ?? ''}" readonly="true">
            </div>
           
            <div class="col-xs-3 col-sm-3"> 
            </div>
        </div>
         
        <div class="row cl">
            <div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-3">
            <input type="hidden" name="id" value="{$vo.id ?? ''}">
                <button type="submit" class="btn btn-primary radius">&nbsp;&nbsp;提交&nbsp;&nbsp;</button>
                <button type="button" class="btn btn-default radius ml-20" onClick="layer_close();">&nbsp;&nbsp;取消&nbsp;&nbsp;</button>
            </div>
        </div>
    </div>
    </form>
</div>
</body>


{/block}
{block name="script"}
<script type="text/javascript" src="__module__/Validform/5.3.2/Validform.min.js"></script>
<script>
    $(function () {
        /* 单选按钮组初始化选中状态，可以设定默认值 */
        $("[name='status'][value='{$vo.status ?? '1'}']").attr("checked",true);
        /* 下拉框初始化选中状态，可以设定默认值 */
        $("[name='select']").find("[value='{$vo.select ?? ''}']").attr("selected",true);

        $('.skin-minimal input').iCheck({
            checkboxClass: 'icheckbox-blue',
            radioClass: 'iradio-blue',
            increaseArea: '20%'
        });

        $("#form").Validform({
            tiptype:2,
            ajaxPost:true,
            showAllError:true,
            callback:function(ret){
                ajax_progress(ret);
            }
        });
    })
</script>
<script type="text/javascript" src="__js__/table.js"></script>
{/block}
